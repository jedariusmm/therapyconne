<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Community - TherapyConnect</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .community-container {
            min-height: 100vh;
            padding-top: 100px;
        }

        .community-header {
            text-align: center;
            padding: 3rem 2rem;
            background: linear-gradient(135deg, rgba(102, 194, 165, 0.1), rgba(141, 211, 199, 0.05));
            border-radius: 20px;
            margin-bottom: 3rem;
        }

        .community-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 3rem;
            border-bottom: 2px solid rgba(102, 194, 165, 0.2);
            flex-wrap: wrap;
        }

        .community-tab {
            background: transparent;
            border: none;
            color: var(--gray);
            padding: 1rem 2rem;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
            position: relative;
        }

        .community-tab.active {
            color: var(--therapeutic-green);
        }

        .community-tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--therapeutic-green);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .community-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
        }

        .posts-section {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .post-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(102, 194, 165, 0.2);
            border-radius: 20px;
            padding: 2rem;
            transition: all 0.3s;
        }

        .post-card:hover {
            border-color: var(--therapeutic-green);
            box-shadow: 0 5px 20px rgba(102, 194, 165, 0.2);
        }

        .post-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 1rem;
        }

        .post-author {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .author-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--therapeutic-green), var(--peaceful-teal));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .author-info h4 {
            color: white;
            margin-bottom: 0.25rem;
        }

        .post-time {
            color: var(--gray);
            font-size: 0.85rem;
        }

        .post-badge {
            background: rgba(102, 194, 165, 0.2);
            color: var(--therapeutic-green);
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .post-content h3 {
            color: white;
            margin-bottom: 0.75rem;
        }

        .post-text {
            color: var(--gray);
            line-height: 1.8;
            margin-bottom: 1rem;
        }

        .post-tags {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-bottom: 1.5rem;
        }

        .tag {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(102, 194, 165, 0.3);
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.85rem;
            color: var(--therapeutic-green);
        }

        .post-actions {
            display: flex;
            gap: 1.5rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(102, 194, 165, 0.2);
        }

        .action-btn {
            background: transparent;
            border: none;
            color: var(--gray);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .action-btn:hover {
            color: var(--therapeutic-green);
        }

        .action-btn.active {
            color: var(--therapeutic-green);
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .sidebar-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(102, 194, 165, 0.2);
            border-radius: 20px;
            padding: 1.5rem;
        }

        .sidebar-card h3 {
            color: white;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .group-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .group-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .group-item:hover {
            background: rgba(102, 194, 165, 0.1);
        }

        .group-icon {
            font-size: 1.5rem;
        }

        .group-info h4 {
            color: white;
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
        }

        .group-members {
            color: var(--gray);
            font-size: 0.8rem;
        }

        .create-post-card {
            background: linear-gradient(135deg, rgba(102, 194, 165, 0.15), rgba(141, 211, 199, 0.1));
            border: 1px solid var(--therapeutic-green);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .create-post-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(102, 194, 165, 0.3);
            border-radius: 12px;
            padding: 1rem;
            color: white;
            margin-bottom: 1rem;
            min-height: 100px;
            resize: vertical;
        }

        .create-post-input:focus {
            outline: none;
            border-color: var(--therapeutic-green);
        }

        .post-btn {
            background: linear-gradient(135deg, var(--therapeutic-green), var(--peaceful-teal));
            color: white;
            border: none;
            padding: 0.75rem 2rem;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .post-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 194, 165, 0.4);
        }

        .event-item {
            background: rgba(255, 255, 255, 0.03);
            border-left: 3px solid var(--therapeutic-green);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .event-date {
            color: var(--therapeutic-green);
            font-weight: 600;
            font-size: 0.85rem;
            margin-bottom: 0.5rem;
        }

        .event-title {
            color: white;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .event-details {
            color: var(--gray);
            font-size: 0.85rem;
        }

        .trending-topic {
            background: rgba(255, 255, 255, 0.03);
            padding: 0.75rem;
            border-radius: 10px;
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .trending-topic:hover {
            background: rgba(102, 194, 165, 0.1);
        }

        .trending-topic h4 {
            color: white;
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
        }

        .trending-topic p {
            color: var(--gray);
            font-size: 0.8rem;
        }

        .support-banner {
            background: linear-gradient(135deg, rgba(102, 194, 165, 0.2), rgba(141, 211, 199, 0.1));
            border: 1px solid var(--therapeutic-green);
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
        }

        .support-banner h4 {
            color: white;
            margin-bottom: 0.5rem;
        }

        .support-banner p {
            color: var(--gray);
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }

        @media (max-width: 968px) {
            .community-grid {
                grid-template-columns: 1fr;
            }

            .sidebar {
                order: -1;
            }
        }
    </style>
</head>
<body>
    <div class="gradient-bg"></div>
    <div class="particles"></div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <span class="logo-icon">üß†</span>
                <span class="logo-text">TherapyConnect</span>
            </div>
            <div class="nav-links">
                <a href="dashboard.html">Dashboard</a>
                <a href="sessions.html">Sessions</a>
                <a href="therapists.html">Therapists</a>
                <a href="resources.html">Resources</a>
                <a href="profile.html">Profile</a>
                <button class="btn btn-secondary" onclick="logout()">Logout</button>
            </div>
        </div>
    </nav>

    <div class="community-container">
        <div class="container">
            <!-- Header -->
            <div class="community-header">
                <h1 style="color: white; margin-bottom: 1rem;">Community üåü</h1>
                <p style="color: var(--gray); max-width: 700px; margin: 0 auto;">
                    Connect with others, share experiences, and find support in our safe and moderated community
                </p>
            </div>

            <!-- Tabs -->
            <div class="community-tabs">
                <button class="community-tab active" onclick="switchCommunityTab('feed')">üè† Feed</button>
                <button class="community-tab" onclick="switchCommunityTab('groups')">üë• Groups</button>
                <button class="community-tab" onclick="switchCommunityTab('events')">üìÖ Events</button>
                <button class="community-tab" onclick="switchCommunityTab('stories')">üí¨ Stories</button>
            </div>

            <div class="community-grid">
                <!-- Main Content -->
                <div>
                    <!-- Feed Tab -->
                    <div class="tab-content active" id="feed-tab">
                        <!-- Create Post -->
                        <div class="create-post-card">
                            <h3 style="color: white; margin-bottom: 1rem;">Share with the Community üíö</h3>
                            <textarea class="create-post-input" placeholder="What's on your mind? Share your thoughts, experiences, or ask for support..."></textarea>
                            <button class="post-btn" onclick="createPost()">‚úçÔ∏è Share Post</button>
                        </div>

                        <div class="posts-section">
                            <!-- Post 1 -->
                            <div class="post-card">
                                <div class="post-header">
                                    <div class="post-author">
                                        <div class="author-avatar">üòä</div>
                                        <div class="author-info">
                                            <h4>Sarah M.</h4>
                                            <div class="post-time">2 hours ago</div>
                                        </div>
                                    </div>
                                    <span class="post-badge">Anxiety Support</span>
                                </div>
                                <div class="post-content">
                                    <h3>Small victories today!</h3>
                                    <p class="post-text">
                                        Just wanted to share that I successfully used the breathing techniques my therapist taught me during a panic attack today. It actually worked! I'm so grateful for this community and all the support. Remember, progress isn't always linear, and that's okay. üíö
                                    </p>
                                    <div class="post-tags">
                                        <span class="tag">#anxiety</span>
                                        <span class="tag">#progress</span>
                                        <span class="tag">#breathing</span>
                                    </div>
                                    <div class="post-actions">
                                        <button class="action-btn active" onclick="toggleLike(this)">
                                            üíö <span>47 Likes</span>
                                        </button>
                                        <button class="action-btn" onclick="toggleComments(this)">
                                            üí¨ <span>12 Comments</span>
                                        </button>
                                        <button class="action-btn" onclick="sharePost(this)">
                                            üîó Share
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Post 2 -->
                            <div class="post-card">
                                <div class="post-header">
                                    <div class="post-author">
                                        <div class="author-avatar">üåà</div>
                                        <div class="author-info">
                                            <h4>Marcus T.</h4>
                                            <div class="post-time">5 hours ago</div>
                                        </div>
                                    </div>
                                    <span class="post-badge">Depression Support</span>
                                </div>
                                <div class="post-content">
                                    <h3>Three months of therapy - my journey</h3>
                                    <p class="post-text">
                                        I've been in therapy for three months now, and I wanted to share some reflections. It hasn't been easy - there were days I didn't want to continue. But looking back, I can see how far I've come. The fog is lifting, slowly but surely. To anyone just starting: give it time, be patient with yourself, and trust the process. You're worth it.
                                    </p>
                                    <div class="post-tags">
                                        <span class="tag">#depression</span>
                                        <span class="tag">#therapy-journey</span>
                                        <span class="tag">#hope</span>
                                    </div>
                                    <div class="post-actions">
                                        <button class="action-btn" onclick="toggleLike(this)">
                                            üíö <span>89 Likes</span>
                                        </button>
                                        <button class="action-btn" onclick="toggleComments(this)">
                                            üí¨ <span>23 Comments</span>
                                        </button>
                                        <button class="action-btn" onclick="sharePost(this)">
                                            üîó Share
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Post 3 -->
                            <div class="post-card">
                                <div class="post-header">
                                    <div class="post-author">
                                        <div class="author-avatar">‚ú®</div>
                                        <div class="author-info">
                                            <h4>Jamie L.</h4>
                                            <div class="post-time">1 day ago</div>
                                        </div>
                                    </div>
                                    <span class="post-badge">Self-Care Tips</span>
                                </div>
                                <div class="post-content">
                                    <h3>My evening routine for better mental health</h3>
                                    <p class="post-text">
                                        Sharing my evening routine that has really helped my mental health:<br>
                                        üåô No screens 1 hour before bed<br>
                                        üìù Gratitude journaling (just 3 things)<br>
                                        üßò 10-minute meditation<br>
                                        üìñ Reading something light<br>
                                        üí§ Consistent bedtime<br><br>
                                        It took about 2 weeks to build the habit, but now I sleep better and wake up feeling more refreshed. What's your evening routine?
                                    </p>
                                    <div class="post-tags">
                                        <span class="tag">#self-care</span>
                                        <span class="tag">#sleep</span>
                                        <span class="tag">#routine</span>
                                    </div>
                                    <div class="post-actions">
                                        <button class="action-btn" onclick="toggleLike(this)">
                                            üíö <span>124 Likes</span>
                                        </button>
                                        <button class="action-btn" onclick="toggleComments(this)">
                                            üí¨ <span>34 Comments</span>
                                        </button>
                                        <button class="action-btn" onclick="sharePost(this)">
                                            üîó Share
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Post 4 -->
                            <div class="post-card">
                                <div class="post-header">
                                    <div class="post-author">
                                        <div class="author-avatar">ü¶ã</div>
                                        <div class="author-info">
                                            <h4>Alex K.</h4>
                                            <div class="post-time">2 days ago</div>
                                        </div>
                                    </div>
                                    <span class="post-badge">Stress Management</span>
                                </div>
                                <div class="post-content">
                                    <h3>How I learned to set boundaries at work</h3>
                                    <p class="post-text">
                                        Setting boundaries was the hardest thing I've learned in therapy, but also the most important. I used to say yes to everything, worked late every night, and burned out completely. My therapist helped me understand that boundaries aren't selfish - they're necessary. Now I actually leave work at 5pm most days. It's been life-changing.
                                    </p>
                                    <div class="post-tags">
                                        <span class="tag">#boundaries</span>
                                        <span class="tag">#work-life-balance</span>
                                        <span class="tag">#burnout</span>
                                    </div>
                                    <div class="post-actions">
                                        <button class="action-btn" onclick="toggleLike(this)">
                                            üíö <span>156 Likes</span>
                                        </button>
                                        <button class="action-btn" onclick="toggleComments(this)">
                                            üí¨ <span>45 Comments</span>
                                        </button>
                                        <button class="action-btn" onclick="sharePost(this)">
                                            üîó Share
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Groups Tab -->
                    <div class="tab-content" id="groups-tab">
                        <div class="posts-section">
                            <div class="post-card">
                                <h3 style="color: white; margin-bottom: 1.5rem;">Join Support Groups</h3>
                                <div class="group-list">
                                    <div class="group-item" onclick="joinGroup('anxiety')">
                                        <div class="group-icon">üò∞</div>
                                        <div class="group-info">
                                            <h4>Anxiety Support Group</h4>
                                            <p class="group-members">1,234 members ‚Ä¢ 45 online now</p>
                                        </div>
                                    </div>
                                    <div class="group-item" onclick="joinGroup('depression')">
                                        <div class="group-icon">üåßÔ∏è</div>
                                        <div class="group-info">
                                            <h4>Depression Recovery</h4>
                                            <p class="group-members">987 members ‚Ä¢ 32 online now</p>
                                        </div>
                                    </div>
                                    <div class="group-item" onclick="joinGroup('mindfulness')">
                                        <div class="group-icon">üßò</div>
                                        <div class="group-info">
                                            <h4>Mindfulness & Meditation</h4>
                                            <p class="group-members">756 members ‚Ä¢ 28 online now</p>
                                        </div>
                                    </div>
                                    <div class="group-item" onclick="joinGroup('trauma')">
                                        <div class="group-icon">üí™</div>
                                        <div class="group-info">
                                            <h4>Trauma Survivors</h4>
                                            <p class="group-members">543 members ‚Ä¢ 15 online now</p>
                                        </div>
                                    </div>
                                    <div class="group-item" onclick="joinGroup('relationships')">
                                        <div class="group-icon">üíë</div>
                                        <div class="group-info">
                                            <h4>Relationship Support</h4>
                                            <p class="group-members">1,098 members ‚Ä¢ 41 online now</p>
                                        </div>
                                    </div>
                                    <div class="group-item" onclick="joinGroup('parents')">
                                        <div class="group-icon">üë®‚Äçüë©‚Äçüëß</div>
                                        <div class="group-info">
                                            <h4>Parents' Mental Health</h4>
                                            <p class="group-members">678 members ‚Ä¢ 22 online now</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Events Tab -->
                    <div class="tab-content" id="events-tab">
                        <div class="posts-section">
                            <div class="post-card">
                                <h3 style="color: white; margin-bottom: 1.5rem;">Upcoming Community Events</h3>
                                <div class="event-item">
                                    <div class="event-date">üìÖ Today, 7:00 PM EST</div>
                                    <div class="event-title">Evening Meditation Session</div>
                                    <p class="event-details">Join us for a guided meditation to unwind from the day</p>
                                </div>
                                <div class="event-item">
                                    <div class="event-date">üìÖ Tomorrow, 12:00 PM EST</div>
                                    <div class="event-title">Anxiety Management Workshop</div>
                                    <p class="event-details">Learn practical techniques to manage anxiety in daily life</p>
                                </div>
                                <div class="event-item">
                                    <div class="event-date">üìÖ Friday, 6:00 PM EST</div>
                                    <div class="event-title">Support Group Check-in</div>
                                    <p class="event-details">Weekly group session for sharing and mutual support</p>
                                </div>
                                <div class="event-item">
                                    <div class="event-date">üìÖ Saturday, 10:00 AM EST</div>
                                    <div class="event-title">Mindfulness for Beginners</div>
                                    <p class="event-details">Introduction to mindfulness practices and techniques</p>
                                </div>
                                <div class="event-item">
                                    <div class="event-date">üìÖ Next Week, 7:00 PM EST</div>
                                    <div class="event-title">Q&A with Dr. Sarah Chen</div>
                                    <p class="event-details">Ask questions about mental health and therapy</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Stories Tab -->
                    <div class="tab-content" id="stories-tab">
                        <div class="posts-section">
                            <div class="post-card">
                                <h3 style="color: white; margin-bottom: 1rem;">Recovery Stories</h3>
                                <p style="color: var(--gray); margin-bottom: 2rem;">
                                    Read inspiring stories of recovery and healing from our community members
                                </p>
                                <div style="text-align: center; padding: 3rem 0;">
                                    <div style="font-size: 4rem; margin-bottom: 1rem;">üìñ</div>
                                    <p style="color: var(--gray);">Recovery stories coming soon...</p>
                                    <button class="post-btn" style="margin-top: 1rem;" onclick="submitStory()">Share Your Story</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sidebar -->
                <div class="sidebar">
                    <!-- Community Guidelines -->
                    <div class="support-banner">
                        <h4>Community Guidelines üìã</h4>
                        <p>Be respectful, supportive, and kind. This is a safe space for everyone.</p>
                        <button class="post-btn" onclick="viewGuidelines()">Read Guidelines</button>
                    </div>

                    <!-- Trending Topics -->
                    <div class="sidebar-card">
                        <h3>üî• Trending Topics</h3>
                        <div class="trending-topic" onclick="searchTopic('self-care')">
                            <h4>#self-care</h4>
                            <p>523 posts this week</p>
                        </div>
                        <div class="trending-topic" onclick="searchTopic('anxiety-tips')">
                            <h4>#anxiety-tips</h4>
                            <p>412 posts this week</p>
                        </div>
                        <div class="trending-topic" onclick="searchTopic('therapy-wins')">
                            <h4>#therapy-wins</h4>
                            <p>298 posts this week</p>
                        </div>
                        <div class="trending-topic" onclick="searchTopic('mindfulness')">
                            <h4>#mindfulness</h4>
                            <p>267 posts this week</p>
                        </div>
                    </div>

                    <!-- Crisis Support -->
                    <div class="sidebar-card" style="background: rgba(239, 68, 68, 0.1); border-color: #ef4444;">
                        <h3 style="color: #ef4444;">üÜò Crisis Support</h3>
                        <p style="color: var(--gray); margin-bottom: 1rem; font-size: 0.9rem;">
                            If you're in crisis, please reach out for immediate help.
                        </p>
                        <div style="color: white; line-height: 2;">
                            <div>üìû <strong>988</strong> - Suicide & Crisis Lifeline</div>
                            <div>üí¨ <strong>Text "HELLO" to 741741</strong></div>
                        </div>
                    </div>

                    <!-- Suggested Groups -->
                    <div class="sidebar-card">
                        <h3>üí° Suggested Groups</h3>
                        <div class="group-list">
                            <div class="group-item" onclick="joinGroup('stress')">
                                <div class="group-icon">üòì</div>
                                <div class="group-info">
                                    <h4>Stress Management</h4>
                                    <p class="group-members">432 members</p>
                                </div>
                            </div>
                            <div class="group-item" onclick="joinGroup('sleep')">
                                <div class="group-icon">üò¥</div>
                                <div class="group-info">
                                    <h4>Better Sleep</h4>
                                    <p class="group-members">567 members</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        // Initialize community data
        let communityPosts = JSON.parse(localStorage.getItem('communityPosts') || '[]');
        let userGroups = JSON.parse(localStorage.getItem('userGroups') || '{}');
        
        // Available support groups
        const supportGroups = {
            anxiety: { name: 'Anxiety Support', icon: 'üßò', members: 1247, description: 'Safe space for anxiety and panic disorder support' },
            depression: { name: 'Depression Support', icon: 'üíô', members: 2156, description: 'Understanding and overcoming depression together' },
            trauma: { name: 'PTSD & Trauma', icon: 'üõ°Ô∏è', members: 892, description: 'Healing from trauma and PTSD recovery' },
            addiction: { name: 'Addiction Recovery', icon: 'üåü', members: 1543, description: 'Support for substance abuse and addiction recovery' },
            relationships: { name: 'Relationship Support', icon: 'üíë', members: 1876, description: 'Healthy relationships and couples support' },
            grief: { name: 'Grief & Loss', icon: 'üïäÔ∏è', members: 734, description: 'Processing grief and bereavement together' },
            stress: { name: 'Stress Management', icon: 'üòì', members: 432, description: 'Coping with daily stress and burnout' },
            sleep: { name: 'Better Sleep', icon: 'üò¥', members: 567, description: 'Improving sleep quality and overcoming insomnia' }
        };

        // Load posts on page load
        window.addEventListener('DOMContentLoaded', () => {
            const user = JSON.parse(localStorage.getItem('therapyConnectUser') || '{}');
            if (!user.email) {
                window.location.href = 'sign-in.html';
                return;
            }
            
            loadPosts();
            loadGroups();
        });

        function switchCommunityTab(tabName) {
            document.querySelectorAll('.community-tab').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(tabName + '-tab').classList.add('active');
        }

        function createPost() {
            const user = JSON.parse(localStorage.getItem('therapyConnectUser'));
            const textarea = document.querySelector('.create-post-input');
            const content = textarea.value.trim();
            
            if (!content) {
                alert('Please write something before posting!');
                return;
            }
            
            const post = {
                id: Date.now(),
                author: user.fullName || 'Anonymous',
                authorEmail: user.email,
                avatar: 'üòä',
                content: content,
                badge: 'Community',
                tags: extractTags(content),
                likes: 0,
                comments: 0,
                timestamp: new Date().toISOString(),
                likedBy: []
            };
            
            communityPosts.unshift(post);
            localStorage.setItem('communityPosts', JSON.stringify(communityPosts));
            
            textarea.value = '';
            loadPosts();
            
            alert('‚úÖ Post created successfully! Your story is now live in the community feed.');
        }

        function extractTags(content) {
            const tags = content.match(/#\w+/g) || [];
            return tags.slice(0, 5);
        }

        function loadPosts() {
            const postsSection = document.querySelector('.posts-section');
            const user = JSON.parse(localStorage.getItem('therapyConnectUser'));
            
            if (communityPosts.length === 0) {
                postsSection.innerHTML = `
                    <div style="text-align: center; padding: 3rem; background: rgba(255,255,255,0.05); border-radius: 20px; border: 2px dashed rgba(102,194,165,0.3);">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">üí¨</div>
                        <h3 style="color: white; margin-bottom: 1rem;">No Posts Yet</h3>
                        <p style="color: var(--gray);">Be the first to share your story with the community!</p>
                    </div>
                `;
                return;
            }
            
            postsSection.innerHTML = communityPosts.map(post => {
                const timeAgo = getTimeAgo(new Date(post.timestamp));
                const isLiked = post.likedBy.includes(user.email);
                
                return `
                    <div class="post-card">
                        <div class="post-header">
                            <div class="post-author">
                                <div class="author-avatar">${post.avatar}</div>
                                <div class="author-info">
                                    <h4>${post.author}</h4>
                                    <div class="post-time">${timeAgo}</div>
                                </div>
                            </div>
                            <span class="post-badge">${post.badge}</span>
                        </div>
                        <div class="post-content">
                            <p class="post-text">${post.content}</p>
                            ${post.tags.length > 0 ? `
                                <div class="post-tags">
                                    ${post.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                                </div>
                            ` : ''}
                            <div class="post-actions">
                                <button class="action-btn ${isLiked ? 'active' : ''}" onclick="toggleLike(${post.id})">
                                    üíö <span>${post.likes} Likes</span>
                                </button>
                                <button class="action-btn" onclick="viewComments(${post.id})">
                                    üí¨ <span>${post.comments} Comments</span>
                                </button>
                                <button class="action-btn" onclick="sharePost(${post.id})">
                                    üîó Share
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function toggleLike(postId) {
            const user = JSON.parse(localStorage.getItem('therapyConnectUser'));
            const post = communityPosts.find(p => p.id === postId);
            
            if (!post) return;
            
            const likedIndex = post.likedBy.indexOf(user.email);
            if (likedIndex > -1) {
                post.likedBy.splice(likedIndex, 1);
                post.likes--;
            } else {
                post.likedBy.push(user.email);
                post.likes++;
            }
            
            localStorage.setItem('communityPosts', JSON.stringify(communityPosts));
            loadPosts();
        }

        function viewComments(postId) {
            const user = JSON.parse(localStorage.getItem('therapyConnectUser'));
            const comment = prompt('Write a supportive comment:');
            
            if (comment && comment.trim()) {
                const post = communityPosts.find(p => p.id === postId);
                if (post) {
                    post.comments++;
                    localStorage.setItem('communityPosts', JSON.stringify(communityPosts));
                    loadPosts();
                    alert('üí¨ Comment added! Thank you for your support.');
                }
            }
        }

        function sharePost(postId) {
            const shareUrl = `https://therapyconne.com/community.html?post=${postId}`;
            navigator.clipboard.writeText(shareUrl).then(() => {
                alert('üîó Post link copied to clipboard! Share it with others.');
            }).catch(() => {
                alert('Post link: ' + shareUrl);
            });
        }

        function joinGroup(groupName) {
            const user = JSON.parse(localStorage.getItem('therapyConnectUser'));
            const userGroupData = userGroups[user.email] || [];
            
            if (userGroupData.includes(groupName)) {
                alert('‚úÖ You are already a member of this group!');
                return;
            }
            
            if (confirm(`Would you like to join the ${supportGroups[groupName].name} support group?`)) {
                userGroupData.push(groupName);
                userGroups[user.email] = userGroupData;
                localStorage.setItem('userGroups', JSON.stringify(userGroups));
                
                alert(`üéâ Welcome to ${supportGroups[groupName].name}! You can now participate in group discussions and access exclusive resources.`);
                loadGroups();
            }
        }

        function loadGroups() {
            const groupsTab = document.getElementById('groups-tab');
            const user = JSON.parse(localStorage.getItem('therapyConnectUser'));
            const userGroupData = userGroups[user.email] || [];
            
            const myGroups = userGroupData.map(groupId => {
                const group = supportGroups[groupId];
                return `
                    <div class="post-card" style="cursor: pointer;" onclick="openGroupChat('${groupId}')">
                        <div style="display: flex; gap: 1.5rem; align-items: center;">
                            <div style="font-size: 3rem;">${group.icon}</div>
                            <div style="flex: 1;">
                                <h3 style="color: white; margin-bottom: 0.5rem;">${group.name}</h3>
                                <p style="color: var(--gray); margin-bottom: 0.5rem;">${group.description}</p>
                                <span style="color: var(--therapeutic-green); font-size: 0.9rem;">üë• ${group.members} members</span>
                            </div>
                            <button class="action-btn" style="background: rgba(239,68,68,0.2); color: #ef4444;" onclick="event.stopPropagation(); leaveGroup('${groupId}')">Leave</button>
                        </div>
                    </div>
                `;
            }).join('');
            
            const availableGroups = Object.keys(supportGroups).filter(id => !userGroupData.includes(id)).map(groupId => {
                const group = supportGroups[groupId];
                return `
                    <div class="post-card" style="cursor: pointer;" onclick="joinGroup('${groupId}')">
                        <div style="display: flex; gap: 1.5rem; align-items: center;">
                            <div style="font-size: 3rem;">${group.icon}</div>
                            <div style="flex: 1;">
                                <h3 style="color: white; margin-bottom: 0.5rem;">${group.name}</h3>
                                <p style="color: var(--gray); margin-bottom: 0.5rem;">${group.description}</p>
                                <span style="color: var(--therapeutic-green); font-size: 0.9rem;">üë• ${group.members} members</span>
                            </div>
                            <button class="action-btn" style="background: linear-gradient(135deg, #66c2a5, #8dd3c7);" onclick="event.stopPropagation(); joinGroup('${groupId}')">Join</button>
                        </div>
                    </div>
                `;
            }).join('');
            
            groupsTab.innerHTML = `
                ${myGroups ? `<h3 style="color: white; margin-bottom: 1.5rem;">Your Groups üíö</h3>${myGroups}` : ''}
                <h3 style="color: white; margin: 2rem 0 1.5rem;">Available Support Groups üåü</h3>
                ${availableGroups}
            `;
        }

        function openGroupChat(groupId) {
            const group = supportGroups[groupId];
            alert(`Opening ${group.name} chat room...\n\nHere you can chat with other members, share experiences, and get support. This feature connects you with real community members.`);
            window.location.href = `messages.html`;
        }

        function leaveGroup(groupId) {
            if (confirm('Are you sure you want to leave this group?')) {
                const user = JSON.parse(localStorage.getItem('therapyConnectUser'));
                const userGroupData = userGroups[user.email] || [];
                const index = userGroupData.indexOf(groupId);
                
                if (index > -1) {
                    userGroupData.splice(index, 1);
                    userGroups[user.email] = userGroupData;
                    localStorage.setItem('userGroups', JSON.stringify(userGroups));
                    loadGroups();
                    alert('You have left the group.');
                }
            }
        }

        function searchTopic(topic) {
            alert(`Searching for posts with ${topic}...`);
        }

        function viewGuidelines() {
            alert('Community Guidelines:\n\n1. Be respectful and supportive\n2. No personal attacks or harassment\n3. Protect privacy - no identifying information\n4. Stay on topic\n5. Report inappropriate content\n6. Seek professional help for crises');
        }

        function submitStory() {
            document.querySelector('.community-tab:first-child').click();
            document.querySelector('.create-post-input').focus();
        }

        function getTimeAgo(date) {
            const seconds = Math.floor((new Date() - date) / 1000);
            if (seconds < 60) return 'Just now';
            if (seconds < 3600) return Math.floor(seconds / 60) + ' minutes ago';
            if (seconds < 86400) return Math.floor(seconds / 3600) + ' hours ago';
            if (seconds < 604800) return Math.floor(seconds / 86400) + ' days ago';
            return Math.floor(seconds / 604800) + ' weeks ago';
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem('therapyConnectUser');
                window.location.href = 'index.html';
            }
        }
    </script>
</body>
</html>
